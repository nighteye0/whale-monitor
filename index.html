<!DOCTYPE html>
<html>
<head>
<title>Whale Monitor</title>
<style>
body{background:#1a1a1a;color:#fff;font-family:Arial;padding:20px}
.container{max-width:1200px;margin:0 auto}
.stats{display:grid;grid-template-columns:1fr 1fr 1fr 1fr;gap:15px;margin-bottom:30px}
.stat{background:#2a2a2a;padding:20px;border-radius:8px}
.num{font-size:32px;font-weight:bold}
table{width:100%;border-collapse:collapse;background:#2a2a2a}
th,td{padding:12px;text-align:left;border-bottom:1px solid #333}
.msg{padding:15px;margin-bottom:20px;border-radius:8px;background:rgba(16,185,129,0.1);color:#10b981}
</style>
</head>
<body>
<div class="container">
<h1>üêã Whale Monitor v2</h1>
<div id="msg">Loading...</div>

<div class="stats">
<div class="stat"><div>Total</div><div class="num" id="total">0</div></div>
<div class="stat"><div>üöÄ BUY</div><div class="num" id="buys">0</div></div>
<div class="stat"><div>üìâ SELL</div><div class="num" id="sells">0</div></div>
<div class="stat"><div>‚û°Ô∏è HOLD</div><div class="num" id="holds">0</div></div>
</div>

<table>
<thead><tr><th>Symbol</th><th>Price</th><th>Action</th><th>Confidence</th><th>Time</th></tr></thead>
<tbody id="tb"></tbody>
</table>
</div>

<script>
const API_URL = new URL('https://jaelynn-uncrystalled-memorisingly.ngrok-free.dev/api/whale-signals');

async function fetchData() {
  try {
    const response = await fetch(API_URL.toString() + '?limit=20&t=' + Date.now(), {
      method: 'GET',
      headers: {
        'ngrok-skip-browser-warning': '69420'
      }
    });
    
    if (!response.ok) throw new Error('Response not ok: ' + response.status);
    
    const data = await response.json();
    
    document.getElementById('msg').innerText = '‚úÖ Connected! ' + data.total + ' signals';
    document.getElementById('total').innerText = data.total;
    document.getElementById('buys').innerText = data.signals.filter(s => s.action === 'BUY').length;
    document.getElementById('sells').innerText = data.signals.filter(s => s.action === 'SELL').length;
    document.getElementById('holds').innerText = data.signals.filter(s => s.action === 'HOLD').length;
    
    let html = '';
    data.signals.slice().reverse().forEach(s => {
      html += '<tr><td>' + s.symbol + '</td><td>$' + s.price.toFixed(2) + '</td><td><b>' + s.action + '</b></td><td>' + (s.confidence*100).toFixed(0) + '%</td><td>' + new Date(s.timestamp).toLocaleTimeString() + '</td></tr>';
    });
    
    document.getElementById('tb').innerHTML = html;
  } catch (error) {
    document.getElementById('msg').innerText = '‚ùå Error: ' + error.message;
  }
}

fetchData();
setInterval(fetchData, 5000);
</script>
</body>
</html>
